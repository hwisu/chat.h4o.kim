import{p as ee,f,E as ae,s as d,c as o,i as p,m as a,n as I,F as oe,a as v,b as te,t as B,j as O,D as re,v as u,$ as le,d as se,g as de,e as ve,x as ne,y as ce,A as ue,h as _e,z as fe,G as he,B as me}from"./svelte.js";import{d as ie,l as ye,s as ke,m as pe,e as be,f as we,r as Se,g as ze}from"./services.js";import"./components.js";function Me(m,t){m.target===m.currentTarget&&t()}var xe=f('<div class="auth-form svelte-1r920as"><label for="password" class="svelte-1r920as">Server Password:</label> <input id="password" type="password" placeholder="Enter server password" class="svelte-1r920as"/> <button class="auth-submit-btn svelte-1r920as"> </button></div>'),Pe=f('<div class="auth-form svelte-1r920as"><label for="api-key" class="svelte-1r920as">OpenRouter API Key:</label> <input id="api-key" type="password" placeholder="sk-or-v1-..." class="svelte-1r920as"/> <small class="api-key-help svelte-1r920as">Get your API key from <a href="https://openrouter.ai/settings/keys" target="_blank" class="svelte-1r920as">OpenRouter</a></small> <button class="auth-submit-btn svelte-1r920as"> </button></div>'),Ae=f('<div class="auth-error svelte-1r920as"> </div>'),Le=f('<div class="auth-modal-backdrop svelte-1r920as" role="dialog" aria-modal="true" aria-labelledby="auth-modal-title" tabindex="0"><div class="auth-modal-content svelte-1r920as"><div class="auth-modal-header svelte-1r920as"><h3 id="auth-modal-title" class="svelte-1r920as">🔐 Choose Authentication Method</h3> <button class="auth-modal-close svelte-1r920as" aria-label="Close">&times;</button></div> <div class="auth-modal-body svelte-1r920as"><div class="auth-method-selector svelte-1r920as"><label class="auth-method-option svelte-1r920as"><input type="radio" class="svelte-1r920as"/> <span class="auth-method-label svelte-1r920as">🔐 Server Login <small class="svelte-1r920as">Authenticate with server password</small></span></label> <label class="auth-method-option svelte-1r920as"><input type="radio" class="svelte-1r920as"/> <span class="auth-method-label svelte-1r920as">🔑 Personal API Key <small class="svelte-1r920as">Use your own OpenRouter API key</small></span></label></div> <!> <!> <!></div></div></div>');function Re(m,t){ee(t,!0);const A=[];let S=I("server"),n=I(""),b=I(""),_=I(!1),y=I("");function L(){var s;(s=t.onClose)==null||s.call(t)}async function C(){var l;if(!a(n).trim()){u(y,"Please enter password");return}u(_,!0),u(y,""),ie();const s=await ye(a(n));s.success?(l=t.onSuccess)==null||l.call(t,{method:"server"}):u(y,s.error||"Login failed",!0),u(_,!1)}async function N(){var l;if(!a(b).trim()){u(y,"Please enter API key");return}if(!a(b).startsWith("sk-or-v1-")){u(y,"Invalid API key format. Must start with sk-or-v1-");return}u(_,!0),u(y,""),ie();const s=await ke(a(b));s.success?(l=t.onSuccess)==null||l.call(t,{method:"api-key"}):u(y,s.error||"API key validation failed",!0),u(_,!1)}function w(s){s.key==="Escape"?L():s.key==="Enter"&&(a(S)==="server"?C():N())}var E=Le();ae("keydown",le,w),E.__click=[Me,L],E.__keydown=w;var j=o(E),F=o(j),T=d(o(F),2);T.__click=L;var W=d(F,2),D=o(W),G=o(D),U=o(G);U.value=U.__value="server";var q=d(G,2),e=o(q);e.value=e.__value="api-key";var r=d(D,2);{var h=s=>{var l=xe(),i=d(o(l),2),k=d(i,2);k.__click=C;var R=o(k);B(M=>{i.disabled=a(_),k.disabled=M,O(R,a(_)?"Logging in...":"Login")},[()=>a(_)||!a(n).trim()]),re(i,()=>a(n),M=>u(n,M)),v(s,l)};p(r,s=>{a(S)==="server"&&s(h)})}var g=d(r,2);{var c=s=>{var l=Pe(),i=d(o(l),2),k=d(i,4);k.__click=N;var R=o(k);B(M=>{i.disabled=a(_),k.disabled=M,O(R,a(_)?"Validating...":"Set API Key")},[()=>a(_)||!a(b).trim()]),re(i,()=>a(b),M=>u(b,M)),v(s,l)};p(g,s=>{a(S)==="api-key"&&s(c)})}var z=d(g,2);{var H=s=>{var l=Ae(),i=o(l);B(()=>O(i,a(y))),v(s,l)};p(z,s=>{a(y)&&s(H)})}oe(A,[],U,()=>a(S),s=>u(S,s)),oe(A,[],e,()=>a(S),s=>u(S,s)),v(m,E),te()}se(["click","keydown"]);const ea=Object.freeze(Object.defineProperty({__proto__:null,default:Re},Symbol.toStringTag,{value:"Module"}));function Ce(m,t){m.target===m.currentTarget&&t()}var Ee=f('<div class="model-list-loading svelte-1g6d7lz"><div class="loading-spinner svelte-1g6d7lz"></div> Loading models...</div>'),Ke=f('<div class="model-list-empty svelte-1g6d7lz">No models available. Please check your authentication.</div>'),Oe=(m,t,A)=>t(a(A).id),je=f('<span class="model-context svelte-1g6d7lz"> </span>'),Te=f('<span class="model-selected-indicator svelte-1g6d7lz">✓</span>'),Ue=f('<button><div class="model-info svelte-1g6d7lz"><div class="model-name svelte-1g6d7lz"> </div> <div class="model-details svelte-1g6d7lz"><span class="model-provider svelte-1g6d7lz"> </span> <!></div></div> <!></button>'),Ie=f('<div class="model-modal-loading svelte-1g6d7lz">Setting model...</div>'),Be=f('<div class="model-modal-backdrop svelte-1g6d7lz" role="dialog" aria-modal="true" aria-labelledby="model-modal-title" tabindex="0"><div class="model-modal-content svelte-1g6d7lz"><div class="model-modal-header svelte-1g6d7lz"><h3 id="model-modal-title" class="svelte-1g6d7lz">🤖 Select Model</h3> <button class="model-modal-close svelte-1g6d7lz" aria-label="Close">&times;</button></div> <div class="model-list svelte-1g6d7lz"><!></div> <!></div></div>');function Ne(m,t){ee(t,!0);const[A,S]=ve(),n=()=>de(pe,"$modelsStore",A);let b=I(!1);function _(){var e;(e=t.onClose)==null||e.call(t)}async function y(e){var r;try{u(b,!0);const h=await be.setModel(e);if(h.success){const g=n().available.find(c=>c.id===e);g&&we({selected:e,selectedInfo:{name:g.name,provider:g.provider,contextSize:g.context_length||128e3}}),(r=t.onSelect)==null||r.call(t,{modelId:e})}else console.error("Failed to set model:",h.error)}catch(h){console.error("Error selecting model:",h)}finally{u(b,!1)}}function L(e){e.key==="Escape"&&_()}function C(e){return e?e.name||e.id||"Unknown Model":""}function N(e){const r={openai:"#00a67e",anthropic:"#d4a574",google:"#4285f4",meta:"#1877f2",mistral:"#ff7000",cohere:"#39594c",default:"#666"};return r[e==null?void 0:e.toLowerCase()]||r.default}var w=Be();ae("keydown",le,L),w.__click=[Ce,_],w.__keydown=L;var E=o(w),j=o(E),F=d(o(j),2);F.__click=_;var T=d(j,2),W=o(T);{var D=e=>{var r=Ee();v(e,r)},G=(e,r)=>{{var h=c=>{var z=Ke();v(c,z)},g=c=>{var z=ne(),H=ce(z);ue(H,1,()=>n().available,me,(s,l)=>{var i=Ue();i.__click=[Oe,y,l];var k=o(i),R=o(k),M=o(R),Q=d(R,2),J=o(Q),X=o(J),Y=d(J,2);{var x=P=>{var V=je(),$=o(V);B(ge=>O($,`${ge??""} tokens`),[()=>a(l).context_length.toLocaleString()]),v(P,V)};p(Y,P=>{a(l).context_length&&P(x)})}var K=d(k,2);{var Z=P=>{var V=Te();v(P,V)};p(K,P=>{a(l).id===n().selected&&P(Z)})}B((P,V,$)=>{_e(i,1,`model-list-item ${a(l).id===n().selected?"selected":""}`,"svelte-1g6d7lz"),i.disabled=a(b),fe(i,"aria-label",`Select ${P??""}`),O(M,V),he(J,`color: ${$??""}`),O(X,a(l).provider||"Unknown")},[()=>C(a(l)),()=>C(a(l)),()=>N(a(l).provider)]),v(s,i)}),v(c,z)};p(e,c=>{n().available.length===0?c(h):c(g,!1)},r)}};p(W,e=>{n().isLoading?e(D):e(G,!1)})}var U=d(T,2);{var q=e=>{var r=Ie();v(e,r)};p(U,e=>{a(b)&&e(q)})}v(m,w),te(),S()}se(["click","keydown"]);const aa=Object.freeze(Object.defineProperty({__proto__:null,default:Ne},Symbol.toStringTag,{value:"Module"}));function Fe(m,t){m.target===m.currentTarget&&t()}var De=f('<div class="role-list-loading svelte-7tpvfm"><div class="loading-spinner svelte-7tpvfm"></div> Loading roles...</div>'),Ge=f('<div class="role-list-empty svelte-7tpvfm">No roles available. Please check your authentication.</div>'),Ve=(m,t,A)=>t(a(A).id),We=f('<div class="role-description svelte-7tpvfm"> </div>'),qe=f('<span class="role-selected-indicator svelte-7tpvfm">✓</span>'),He=f('<button><div class="role-info svelte-7tpvfm"><div class="role-name svelte-7tpvfm"> </div> <!></div> <!></button>'),Je=f('<div class="role-modal-loading svelte-7tpvfm">Setting role...</div>'),Qe=f('<div class="role-modal-backdrop svelte-7tpvfm" role="dialog" aria-modal="true" aria-labelledby="role-modal-title" tabindex="0"><div class="role-modal-content svelte-7tpvfm"><div class="role-modal-header svelte-7tpvfm"><h3 id="role-modal-title" class="svelte-7tpvfm">🎭 Select Role</h3> <button class="role-modal-close svelte-7tpvfm" aria-label="Close">&times;</button></div> <div class="role-list svelte-7tpvfm"><!></div> <!></div></div>');function Xe(m,t){ee(t,!0);const[A,S]=ve(),n=()=>de(Se,"$rolesStore",A);let b=I(!1);function _(){var e;(e=t.onClose)==null||e.call(t)}async function y(e){var r;try{u(b,!0);const h=await be.setRole(e);if(h.success){const g=n().available.find(c=>c.id===e);g&&ze({selected:e,selectedInfo:{name:g.name,description:g.description,system_prompt:g.system_prompt}}),(r=t.onSelect)==null||r.call(t,{roleId:e})}else console.error("Failed to set role:",h.error)}catch(h){console.error("Error selecting role:",h)}finally{u(b,!1)}}function L(e){e.key==="Escape"&&_()}function C(e){return e?e.name||e.id||"Unknown Role":""}function N(e){return e?e.length>100?e.substring(0,100)+"...":e:""}var w=Qe();ae("keydown",le,L),w.__click=[Fe,_],w.__keydown=L;var E=o(w),j=o(E),F=d(o(j),2);F.__click=_;var T=d(j,2),W=o(T);{var D=e=>{var r=De();v(e,r)},G=(e,r)=>{{var h=c=>{var z=Ge();v(c,z)},g=c=>{var z=ne(),H=ce(z);ue(H,1,()=>n().available,me,(s,l)=>{var i=He();i.__click=[Ve,y,l];var k=o(i),R=o(k),M=o(R),Q=d(R,2);{var J=x=>{var K=We(),Z=o(K);B(P=>O(Z,P),[()=>N(a(l).description)]),v(x,K)};p(Q,x=>{a(l).description&&x(J)})}var X=d(k,2);{var Y=x=>{var K=qe();v(x,K)};p(X,x=>{a(l).id===n().selected&&x(Y)})}B((x,K)=>{_e(i,1,`role-list-item ${a(l).id===n().selected?"selected":""}`,"svelte-7tpvfm"),i.disabled=a(b),fe(i,"aria-label",`Select ${x??""}`),O(M,K)},[()=>C(a(l)),()=>C(a(l))]),v(s,i)}),v(c,z)};p(e,c=>{n().available.length===0?c(h):c(g,!1)},r)}};p(W,e=>{n().isLoading?e(D):e(G,!1)})}var U=d(T,2);{var q=e=>{var r=Je();v(e,r)};p(U,e=>{a(b)&&e(q)})}v(m,w),te(),S()}se(["click","keydown"]);const ta=Object.freeze(Object.defineProperty({__proto__:null,default:Xe},Symbol.toStringTag,{value:"Module"}));export{ea as A,aa as M,ta as R};
