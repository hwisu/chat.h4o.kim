import{p as $,f as u,C as ee,s as r,c as s,i as S,k as a,l as T,D as se,a as v,b as ae,t as U,g as j,B as ie,q as c,$ as te,d as le,v as oe,w as de,y as ve,e as ne,x as ce,E as me,z as ue}from"./svelte.js";import{d as re,l as be,s as ge,m as G,e as _e,f as he,r as V,g as ye}from"./services.js";function ke(f,t){f.target===f.currentTarget&&t()}var pe=u('<div class="auth-form svelte-1r920as"><label for="password" class="svelte-1r920as">Server Password:</label> <input id="password" type="password" placeholder="Enter server password" class="svelte-1r920as"/> <button class="auth-submit-btn svelte-1r920as"> </button></div>'),we=u('<div class="auth-form svelte-1r920as"><label for="api-key" class="svelte-1r920as">OpenRouter API Key:</label> <input id="api-key" type="password" placeholder="sk-or-v1-..." class="svelte-1r920as"/> <small class="api-key-help svelte-1r920as">Get your API key from <a href="https://openrouter.ai/settings/keys" target="_blank" class="svelte-1r920as">OpenRouter</a></small> <button class="auth-submit-btn svelte-1r920as"> </button></div>'),Se=u('<div class="auth-error svelte-1r920as"> </div>'),ze=u('<div class="auth-modal-backdrop svelte-1r920as" role="dialog" aria-modal="true" aria-labelledby="auth-modal-title" tabindex="0"><div class="auth-modal-content svelte-1r920as"><div class="auth-modal-header svelte-1r920as"><h3 id="auth-modal-title" class="svelte-1r920as">🔐 Choose Authentication Method</h3> <button class="auth-modal-close svelte-1r920as" aria-label="Close">&times;</button></div> <div class="auth-modal-body svelte-1r920as"><div class="auth-method-selector svelte-1r920as"><label class="auth-method-option svelte-1r920as"><input type="radio" class="svelte-1r920as"/> <span class="auth-method-label svelte-1r920as">🔐 Server Login <small class="svelte-1r920as">Authenticate with server password</small></span></label> <label class="auth-method-option svelte-1r920as"><input type="radio" class="svelte-1r920as"/> <span class="auth-method-label svelte-1r920as">🔑 Personal API Key <small class="svelte-1r920as">Use your own OpenRouter API key</small></span></label></div> <!> <!> <!></div></div></div>');function Me(f,t){$(t,!0);const m=[];let g=T("server"),R=T(""),z=T(""),b=T(!1),k=T("");function p(){var l;(l=t.onClose)==null||l.call(t)}async function I(){var d;if(!a(R).trim()){c(k,"Please enter password");return}c(b,!0),c(k,""),re();const l=await be(a(R));l.success?(d=t.onSuccess)==null||d.call(t,{method:"server"}):c(k,l.error||"Login failed",!0),c(b,!1)}async function K(){var d;if(!a(z).trim()){c(k,"Please enter API key");return}if(!a(z).startsWith("sk-or-v1-")){c(k,"Invalid API key format. Must start with sk-or-v1-");return}c(b,!0),c(k,""),re();const l=await ge(a(z));l.success?(d=t.onSuccess)==null||d.call(t,{method:"api-key"}):c(k,l.error||"API key validation failed",!0),c(b,!1)}function B(l){l.key==="Escape"?p():l.key==="Enter"&&(a(g)==="server"?I():K())}var L=ze();ee("keydown",te,B),L.__click=[ke,p],L.__keydown=B;var W=s(L),N=s(W),H=r(s(N),2);H.__click=p;var J=r(N,2),D=s(J),e=s(D),i=s(e);i.value=i.__value="server";var h=r(e,2),_=s(h);_.value=_.__value="api-key";var o=r(D,2);{var M=l=>{var d=pe(),w=r(s(d),2),x=r(w,2);x.__click=I;var E=s(x);U(P=>{w.disabled=a(b),x.disabled=P,j(E,a(b)?"Logging in...":"Login")},[()=>a(b)||!a(R).trim()]),ie(w,()=>a(R),P=>c(R,P)),v(l,d)};S(o,l=>{a(g)==="server"&&l(M)})}var F=r(o,2);{var Q=l=>{var d=we(),w=r(s(d),2),x=r(w,4);x.__click=K;var E=s(x);U(P=>{w.disabled=a(b),x.disabled=P,j(E,a(b)?"Validating...":"Set API Key")},[()=>a(b)||!a(z).trim()]),ie(w,()=>a(z),P=>c(z,P)),v(l,d)};S(F,l=>{a(g)==="api-key"&&l(Q)})}var n=r(F,2);{var y=l=>{var d=Se(),w=s(d);U(()=>j(w,a(k))),v(l,d)};S(n,l=>{a(k)&&l(y)})}se(m,[],i,()=>a(g),l=>c(g,l)),se(m,[],_,()=>a(g),l=>c(g,l)),v(f,L),ae()}le(["click","keydown"]);const Je=Object.freeze(Object.defineProperty({__proto__:null,default:Me},Symbol.toStringTag,{value:"Module"}));function xe(f,t){f.target===f.currentTarget&&t()}var Pe=u('<div class="model-list-loading svelte-1g6d7lz"><div class="loading-spinner svelte-1g6d7lz"></div> Loading models...</div>'),Ae=u('<div class="model-list-empty svelte-1g6d7lz">No models available. Please check your authentication.</div>'),Ce=(f,t,m)=>t(a(m).id),Le=u('<span class="model-context svelte-1g6d7lz"> </span>'),Re=u('<span class="model-selected-indicator svelte-1g6d7lz">✓</span>'),Ee=u('<button><div class="model-info svelte-1g6d7lz"><div class="model-name svelte-1g6d7lz"> </div> <div class="model-details svelte-1g6d7lz"><span class="model-provider svelte-1g6d7lz"> </span> <!></div></div> <!></button>'),Ke=u('<div class="model-modal-loading svelte-1g6d7lz">Setting model...</div>'),Oe=u('<div class="model-modal-backdrop svelte-1g6d7lz" role="dialog" aria-modal="true" aria-labelledby="model-modal-title" tabindex="0"><div class="model-modal-content svelte-1g6d7lz"><div class="model-modal-header svelte-1g6d7lz"><h3 id="model-modal-title" class="svelte-1g6d7lz">🤖 Select Model</h3> <button class="model-modal-close svelte-1g6d7lz" aria-label="Close">&times;</button></div> <div class="model-list svelte-1g6d7lz"><!></div> <!></div></div>');function je(f,t){$(t,!0);let m=T(!1);function g(){var e;(e=t.onClose)==null||e.call(t)}async function R(e){var i;try{c(m,!0);const h=await _e.setModel(e);if(h.success){const _=G.available.find(o=>o.id===e);_&&he({selected:e,selectedInfo:{name:_.name,provider:_.provider,contextSize:_.context_length||128e3}}),(i=t.onSelect)==null||i.call(t,{modelId:e})}else console.error("Failed to set model:",h.error)}catch(h){console.error("Error selecting model:",h)}finally{c(m,!1)}}function z(e){e.key==="Escape"&&g()}function b(e){return e?e.name||e.id||"Unknown Model":""}function k(e){const i={openai:"#00a67e",anthropic:"#d4a574",google:"#4285f4",meta:"#1877f2",mistral:"#ff7000",cohere:"#39594c",default:"#666"};return i[e==null?void 0:e.toLowerCase()]||i.default}var p=Oe();ee("keydown",te,z),p.__click=[xe,g],p.__keydown=z;var I=s(p),K=s(I),B=r(s(K),2);B.__click=g;var L=r(K,2),W=s(L);{var N=e=>{var i=Pe();v(e,i)},H=(e,i)=>{{var h=o=>{var M=Ae();v(o,M)},_=o=>{var M=oe(),F=de(M);ve(F,17,()=>G.available,ue,(Q,n)=>{var y=Ee();y.__click=[Ce,R,n];var l=s(y),d=s(l),w=s(d),x=r(d,2),E=s(x),P=s(E),X=r(E,2);{var A=C=>{var q=Le(),Z=s(q);U(fe=>j(Z,`${fe??""} tokens`),[()=>a(n).context_length.toLocaleString()]),v(C,q)};S(X,C=>{a(n).context_length&&C(A)})}var O=r(l,2);{var Y=C=>{var q=Re();v(C,q)};S(O,C=>{a(n).id===G.selected&&C(Y)})}U((C,q,Z)=>{ne(y,1,`model-list-item ${a(n).id===G.selected?"selected":""}`,"svelte-1g6d7lz"),y.disabled=a(m),ce(y,"aria-label",`Select ${C??""}`),j(w,q),me(E,`color: ${Z??""}`),j(P,a(n).provider||"Unknown")},[()=>b(a(n)),()=>b(a(n)),()=>k(a(n).provider)]),v(Q,y)}),v(o,M)};S(e,o=>{G.available.length===0?o(h):o(_,!1)},i)}};S(W,e=>{G.isLoading?e(N):e(H,!1)})}var J=r(L,2);{var D=e=>{var i=Ke();v(e,i)};S(J,e=>{a(m)&&e(D)})}v(f,p),ae()}le(["click","keydown"]);const Qe=Object.freeze(Object.defineProperty({__proto__:null,default:je},Symbol.toStringTag,{value:"Module"}));function Te(f,t){f.target===f.currentTarget&&t()}var Ue=u('<div class="role-list-loading svelte-7tpvfm"><div class="loading-spinner svelte-7tpvfm"></div> Loading roles...</div>'),Ie=u('<div class="role-list-empty svelte-7tpvfm">No roles available. Please check your authentication.</div>'),Be=(f,t,m)=>t(a(m).id),Ne=u('<div class="role-description svelte-7tpvfm"> </div>'),De=u('<span class="role-selected-indicator svelte-7tpvfm">✓</span>'),Fe=u('<button><div class="role-info svelte-7tpvfm"><div class="role-name svelte-7tpvfm"> </div> <!></div> <!></button>'),qe=u('<div class="role-modal-loading svelte-7tpvfm">Setting role...</div>'),Ge=u('<div class="role-modal-backdrop svelte-7tpvfm" role="dialog" aria-modal="true" aria-labelledby="role-modal-title" tabindex="0"><div class="role-modal-content svelte-7tpvfm"><div class="role-modal-header svelte-7tpvfm"><h3 id="role-modal-title" class="svelte-7tpvfm">🎭 Select Role</h3> <button class="role-modal-close svelte-7tpvfm" aria-label="Close">&times;</button></div> <div class="role-list svelte-7tpvfm"><!></div> <!></div></div>');function Ve(f,t){$(t,!0);let m=T(!1);function g(){var e;(e=t.onClose)==null||e.call(t)}async function R(e){var i;try{c(m,!0);const h=await _e.setRole(e);if(h.success){const _=V.available.find(o=>o.id===e);_&&ye({selected:e,selectedInfo:{name:_.name,description:_.description,system_prompt:_.system_prompt}}),(i=t.onSelect)==null||i.call(t,{roleId:e})}else console.error("Failed to set role:",h.error)}catch(h){console.error("Error selecting role:",h)}finally{c(m,!1)}}function z(e){e.key==="Escape"&&g()}function b(e){return e?e.name||e.id||"Unknown Role":""}function k(e){return e?e.length>100?e.substring(0,100)+"...":e:""}var p=Ge();ee("keydown",te,z),p.__click=[Te,g],p.__keydown=z;var I=s(p),K=s(I),B=r(s(K),2);B.__click=g;var L=r(K,2),W=s(L);{var N=e=>{var i=Ue();v(e,i)},H=(e,i)=>{{var h=o=>{var M=Ie();v(o,M)},_=o=>{var M=oe(),F=de(M);ve(F,17,()=>V.available,ue,(Q,n)=>{var y=Fe();y.__click=[Be,R,n];var l=s(y),d=s(l),w=s(d),x=r(d,2);{var E=A=>{var O=Ne(),Y=s(O);U(C=>j(Y,C),[()=>k(a(n).description)]),v(A,O)};S(x,A=>{a(n).description&&A(E)})}var P=r(l,2);{var X=A=>{var O=De();v(A,O)};S(P,A=>{a(n).id===V.selected&&A(X)})}U((A,O)=>{ne(y,1,`role-list-item ${a(n).id===V.selected?"selected":""}`,"svelte-7tpvfm"),y.disabled=a(m),ce(y,"aria-label",`Select ${A??""}`),j(w,O)},[()=>b(a(n)),()=>b(a(n))]),v(Q,y)}),v(o,M)};S(e,o=>{V.available.length===0?o(h):o(_,!1)},i)}};S(W,e=>{V.isLoading?e(N):e(H,!1)})}var J=r(L,2);{var D=e=>{var i=qe();v(e,i)};S(J,e=>{a(m)&&e(D)})}v(f,p),ae()}le(["click","keydown"]);const Xe=Object.freeze(Object.defineProperty({__proto__:null,default:Ve},Symbol.toStringTag,{value:"Module"}));export{Je as A,Qe as M,Xe as R};
